// Author: Adam Henry, adlhenry@ucsc.edu

SYNOPSIS
	CryptoFS - A simple file encryption system for freeBSD.
	
	protectfile [-e(--encrypt) | -d(--decrypt)] <key> <file>
	
		-e, --encrypt - encrypts <file> with the provided <key>
		-d, --decrypt - decrypts <file> with the provided <key>
		<key> - a 16-digit hex number, without the 0x prefix
		<file> - filename of the file to be encrypted or decrypted
		
		protectfile will either encrypt or decrypt a file depending on
		the option specified. The program uses 128-bit AES encryption and
		uses a file's sticky bit to indicate encryption.
	
	setkey [-a <key> | -r]
		
		-a - adds <key> for a user using the setkey() system call
		-r - removes an existing key for a user
		<key> - a 16-digit hex number, without the 0x prefix
		
		setkey will either add, replace, or remove a key from the key
		table for a specific user. All key modification requests are
		handled by the setkey() system call.
	
	setkey() - key modification system call
		
		setkey() takes in two unsigned integers and uses them to set a
		user's key in the kernel key table. If the key modification
		request cannot be fulfilled a non-zero error code is returned.
		
		Error codes
		
		KS_INVALIDKEY - the key provided is invalid
		
		KS_KEYLISTFULL - the key table is full
						 (default: more than 16 entries)
	
DATA
encrypt.c
	execname - program name string
	eflag - either 0 or 1, 1 if -e(--encrypt) was specified
	dflag - either 0 or 1, 1 if -d(--decrypt) was specified
	
setkey.c
	execname - program name string
	aflag - either 0 or 1, 1 if -a(add key) was specified
	rflag - either 0 or 1, 1 if -r(remove key) was specified
	key - 16-digit hex key string
	
setkey.h
	KS_MAXKEYS - the number of keys storable in the key table (default 16)
	KS_INVALIDKEY - attempt to remove a non-existent key
	KS_KEYLISTFULL - the key table has reached its capacity
	keyset - a struct to contain key information for a user,
		ks_uid - user id of the key owner
		ks_k0 - first half of the user key
		ks_k1 - second half of the user key
		ks_hexkey = 16-digit hex string version of the user key
	
kern_setkey.c
	keylist	- an array of KS_MAXKEYS number of keyset pointers
	keylist_index - the current number of null and non-null keys
					in the keylist
	
FUNCTIONS
encrypt.c
	usage()
		purpose - print a usage message to stderr
		inputs - none
		outputs - none
		assumptions - called when a usage error happens
	
	parse_options()
		purpose - parse the user options and check for errors
		inputs - int and a char pointer array
		outputs - none
		assumptions - the int contains the number of arguments in the
					char pointer array, the char pointer array is non-null
	
	hexvalue()
		purpose - returns a character's hexidecimal equivalent
		inputs - a char
		outputs - an int
		assumptions - the char is hex value, if it is not the program
					  exits
	
	getpassword()
		purpose - populate the lower-order bits of a 128-bit key from
				  a 64-bit hex string
		inputs - two char pointers and an int
		outputs - none
		assumptions - both char pointers are non-null and the int is the
					  length of the second char pointer's array
	
	aes_encrypt()
		purpose - encrypt or decrypt a file using 128-bit AES encryption
		inputs - two char pointers
		outputs - none
		assumptions - the char pointers are non-null
	
	main()
		purpose - check if a file is to be encrypted or decrypted
				  and perform the transformation if the sticky bit is
				  properly set
		inputs - an int and a char pointer array
		outputs - none
		assumptions - the int contains the length of the char pointer
					  array and the char pointer array is non-null
	
setkey.c
	usage()
		purpose - print a usage message to stderr
		inputs - none
		outputs - none
		assumptions - called when a usage error happens
	
	parse_options()
		purpose - parse the user options and check for errors
		inputs - int and a char pointer array
		outputs - none
		assumptions - the int contains the number of arguments in the
					char pointer array, the char pointer array is non-null
	
	set_keys()
		purpose - split a 64-bit hex key string into two 32-bit ints
		inputs - two int pointers
		outputs - none
		assumptions - the 64-bit hex key is non-null and 16-digits long
	
	set_kernkey()
		purpose - call setkey() and check the return value for error codes
		inputs - two ints
		outputs - none
		assumptions - the ints contain the key to be inserted or are both
					  0 to signal key removal
	
	main()
		purpose - check if a key is to be added or removed and
				  call setkey() in an attempt to perform the user
				  request
		inputs - an int and a char pointer array
		outputs - none
		assumptions - the int contains the length of the char pointer
					  array and the char pointer array is non-null
	
kern_setkey.c
	sk_getkey()
		purpose - 
		inputs - 
		outputs - 
		assumptions - 
	
	sk_hexkey()
		purpose - 
		inputs - 
		outputs - 
		assumptions - 
	
	sk_insertkey()
		purpose - 
		inputs - 
		outputs - 
		assumptions - 
	
	sys_setkey()
		purpose - 
		inputs - 
		outputs - 
		assumptions - 
	
null_vnops.c
	
